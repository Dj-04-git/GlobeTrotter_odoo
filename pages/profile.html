<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - World Heritage Sites</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            position: relative;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Hamburger Menu Styles */
        .hamburger-menu {
            position: absolute;
            top: 0;
            right: 0;
            cursor: pointer;
            z-index: 1000;
        }

        .hamburger-icon {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 30px;
            height: 24px;
            justify-content: space-between;
        }

        .hamburger-icon span {
            width: 100%;
            height: 3px;
            background-color: white;
            border-radius: 2px;
            transition: all 0.3s ease;
            display: block;
        }

        .hamburger-menu.active .hamburger-icon span:nth-child(1) {
            transform: rotate(45deg) translate(10px, 10px);
        }

        .hamburger-menu.active .hamburger-icon span:nth-child(2) {
            opacity: 0;
        }

        .hamburger-menu.active .hamburger-icon span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }

        .dropdown-menu {
            position: absolute;
            top: 40px;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            min-width: 150px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        .dropdown-menu.show {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-menu a,
        .dropdown-menu button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            text-decoration: none;
            color: #333;
            font-size: 1em;
            border: none;
            background: none;
            cursor: pointer;
            text-align: left;
            transition: background-color 0.3s ease;
        }

        .dropdown-menu a:hover,
        .dropdown-menu button:hover {
            background-color: #f0f0f0;
        }

        .dropdown-menu a:first-child,
        .dropdown-menu button:first-child {
            border-top: none;
        }

        .dropdown-menu a + a,
        .dropdown-menu button + a,
        .dropdown-menu a + button,
        .dropdown-menu button + button {
            border-top: 1px solid #e0e0e0;
        }

        /* Profile Card Styles */
        .profile-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }

        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 3em;
            color: white;
        }

        .profile-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 5px;
        }

        .profile-subtitle {
            color: #667eea;
            font-size: 1.1em;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-item {
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-size: 0.85em;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.2em;
            color: #333;
            font-weight: 500;
            word-break: break-all;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        .nav-links {
            text-align: center;
            margin-top: 40px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            font-size: 1.1em;
            transition: opacity 0.3s;
        }

        .nav-links a:hover {
            opacity: 0.8;
        }

        .edit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .edit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .profile-card {
                padding: 20px;
            }

            .nav-links a {
                display: block;
                margin: 10px 0;
            }

            header {
                padding-right: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üë§ User Profile</h1>
            <p class="subtitle">Your Account Information</p>

            <!-- Hamburger Menu -->
            <div class="hamburger-menu" id="hamburgerMenu">
                <div class="hamburger-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <a href="#profile">üë§ Profile</a>
                    <a href="dashboard.html">üìä Dashboard</a>
                    <button id="logoutBtn">üö™ Logout</button>
                </div>
            </div>
        </header>

        <div id="profileContainer">
            <div class="loading">Loading profile information...</div>
        </div>

        <div class="nav-links">
            <a href="dashboard.html">‚Üê Back to Dashboard</a>
        </div>
    </div>

    <script>
        // Hamburger Menu Toggle
        const hamburgerMenu = document.getElementById('hamburgerMenu');
        const dropdownMenu = document.getElementById('dropdownMenu');

        hamburgerMenu.addEventListener('click', function(e) {
            e.stopPropagation();
            hamburgerMenu.classList.toggle('active');
            dropdownMenu.classList.toggle('show');
        });

        // Close menu when clicking outside
        document.addEventListener('click', function() {
            hamburgerMenu.classList.remove('active');
            dropdownMenu.classList.remove('show');
        });

        // Close menu when a link is clicked
        dropdownMenu.addEventListener('click', function(e) {
            if (e.target.tagName === 'A') {
                hamburgerMenu.classList.remove('active');
                dropdownMenu.classList.remove('show');
            }
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            localStorage.clear();
            sessionStorage.clear();
            window.location.href = '/login';
        });

        // Prevent menu from closing when clicking inside it
        dropdownMenu.addEventListener('click', function(e) {
            e.stopPropagation();
        });

        // Fetch Profile Data
        function fetchProfile() {
            const token = localStorage.getItem('token');
            const userId = localStorage.getItem('userId');

            if (!token || !userId) {
                showError('Please login first');
                setTimeout(() => {
                    window.location.href = '/login';
                }, 2000);
                return;
            }

            fetch(`/api/auth/profile/${userId}`, {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showError(data.error);
                    } else {
                        displayProfile(data.user);
                    }
                })
                .catch(error => {
                    console.error('Error fetching profile:', error);
                    showError('Failed to load profile information');
                });
        }

        function displayProfile(user) {
            const profileContainer = document.getElementById('profileContainer');
            profileContainer.innerHTML = `
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar">üë§</div>
                        <div class="profile-title">${escapeHtml(user.name)}</div>
                        <div class="profile-subtitle">Member</div>
                    </div>

                    <div class="profile-info">
                        <div class="info-item">
                            <div class="info-label">User ID</div>
                            <div class="info-value">${user.id}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Full Name</div>
                            <div class="info-value">${escapeHtml(user.name)}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Email Address</div>
                            <div class="info-value">${escapeHtml(user.email)}</div>
                        </div>
                    </div>

                    <button class="edit-btn">‚úèÔ∏è Edit Profile (Coming Soon)</button>
                </div>
            `;
        }

        function showError(message) {
            const profileContainer = document.getElementById('profileContainer');
            profileContainer.innerHTML = `
                <div class="error">${escapeHtml(message)}</div>
            `;
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // Load profile when page loads
        document.addEventListener('DOMContentLoaded', fetchProfile);
    </script>
</body>
</html>
